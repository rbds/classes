function Schur_HW6_1
close all;

theta=2.5;
k=ones(2,1);
m=0.5;
g=9.81;
e3=[0 0 1]';

X0=[1; -1; 0; 2; -1; 1];
N=501;
t=linspace(0,30,N);

[t X]=ode45(@eom,t,X0);


p = X(:,1:3);
v = X(:,4:6);

for i=1:N
    u(i,:) = control(t(i), X(i,:));
end

figure;plot(t,x);ylabel('x');
figure;plot(t,theta_hat);ylabel('$\hat\theta$','interpreter','latex');
figure;plot(t,u);ylabel('u');


end


function X_dot=eom(t,X)

p=X(1:3);
v = X(4:6);

u=control(t,X);

p_dot=v;
v_dot = g*e3 + u/m - theta/m*sat(v);

X_dot=[x_dot;theta_hat_dot];
end

function u=control(t,X)
theta=2.5;
k=ones(2,1);
m=0.5;
g=9.81;
e3=[0 0 1]';


p=X(1:3);
v=X(4:6);

u= -k(1)*p - k(2)*v - m*g*e3;

end

function s = sat(z)
    for i=1:size(z,1)
       if x(i) 
    end

end